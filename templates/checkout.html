<div class="container mx-auto px-4 py-12">
<div class="text-center py-8">
<h2 class="text-3xl font-bold text-white tracking-wider" data-i18n="checkoutTitle">Finalizar Compra Segura</h2>
</div>
<div class="max-w-4xl mx-auto">
<div class="progress-bar">
<div class="progress-indicator"></div>
<div class="progress-step active" id="step-shipping">
<div class="progress-step-circle">1</div>
<span data-i18n="progressStepAddress">Morada</span>
</div>
<div class="progress-step" id="step-payment">
<div class="progress-step-circle">2</div>
<span data-i18n="progressStepPayment">Pagamento</span>
</div>
<div class="progress-step" id="step-review">
<div class="progress-step-circle">3</div>
<span data-i18n="progressStepReview">Revisão</span>
</div>
</div>
<div class="flex flex-col-reverse lg:flex-row gap-12">
<div class="w-full lg:w-2/3">
<form id="checkout-form" novalidate="">
<div id="checkout-step-1">
<div class="mb-8">
<h2 class="text-2xl font-bold mb-4" data-i18n="contactInfoTitle">Informação de Contacto</h2>
<label class="sr-only" for="checkout-email" data-i18n="emailLabel">Email</label>
<input class="w-full p-3 rounded-md form-input" id="checkout-email" name="email" placeholder="Endereço de Email" required="" type="email" data-i18n-placeholder="emailPlaceholder"/>
<p class="error-message" data-i18n="newsletterInvalidEmail">Por favor, insira um email válido.</p>
</div>
<div class="mb-8">
<h2 class="text-2xl font-bold mb-4" data-i18n="shippingAddressTitle">Endereço de Envio</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div>
<label class="sr-only" for="checkout-firstName" data-i18n="firstNameLabel">Primeiro Nome</label>
<input class="p-3 w-full rounded-md form-input" id="checkout-firstName" name="firstName" placeholder="Primeiro Nome" required="" type="text" data-i18n-placeholder="firstNamePlaceholder"/>
<p class="error-message" data-i18n="fieldRequired">Campo obrigatório.</p>
</div>
<div>
<label class="sr-only" for="checkout-lastName" data-i18n="lastNameLabel">Último Nome</label>
<input class="p-3 w-full rounded-md form-input" id="checkout-lastName" name="lastName" placeholder="Último Nome" required="" type="text" data-i18n-placeholder="lastNamePlaceholder"/>
<p class="error-message" data-i18n="fieldRequired">Campo obrigatório.</p>
</div>
<div class="md:col-span-2">
<label class="sr-only" for="checkout-address" data-i18n="addressLabel">Morada</label>
<input class="p-3 w-full rounded-md form-input" id="checkout-address" name="address" placeholder="Morada" required="" type="text" data-i18n-placeholder="addressPlaceholder"/>
<p class="error-message" data-i18n="fieldRequired">Campo obrigatório.</p>
</div>
<div>
<label class="sr-only" for="checkout-city" data-i18n="cityLabel">Cidade</label>
<input class="p-3 w-full rounded-md form-input" id="checkout-city" name="city" placeholder="Cidade" required="" type="text" data-i18n-placeholder="cityPlaceholder"/>
<p class="error-message" data-i18n="fieldRequired">Campo obrigatório.</p>
</div>
<div>
<label class="sr-only" for="checkout-zip" data-i18n="zipLabel">Código Postal</label>
<input class="p-3 w-full rounded-md form-input" id="checkout-zip" name="zip" placeholder="Código Postal" required="" type="text" data-i18n-placeholder="zipPlaceholder"/>
<p class="error-message" data-i18n="fieldRequired">Campo obrigatório.</p>
</div>
</div>
</div>
</div>
<div class="hidden" id="checkout-step-2">
    <h2 class="text-2xl font-bold mb-4" data-i18n="paymentDetailsTitle">Pagamento Seguro</h2>
    <p class="text-gray-400 mb-6" data-i18n="paymentViaStripe">Pagamento processado via Stripe. Aceitamos Cartão de Crédito e MB Way.</p>

    <!-- Stripe Payment Element will be inserted here by JavaScript -->
    <div id="payment-element" class="mb-4"></div>

    <!-- Used to display form errors from Stripe -->
    <div id="payment-message" class="hidden text-red-500 text-sm mb-4"></div>

    <p class="text-xs text-gray-500 flex items-center gap-2 pt-2" data-i18n-html="secureTransaction"><i class="fas fa-lock"></i>Transação segura e encriptada.</p>
</div>
<div class="hidden" id="checkout-step-3">
<h2 class="text-2xl font-bold mb-6" data-i18n="reviewOrderTitle">Rever a sua Encomenda</h2>
<div class="space-y-6">
<div>
<h3 class="font-semibold text-lg mb-2 text-accent" data-i18n="reviewShippingAddress">Endereço de Envio</h3>
<div class="text-gray-300 bg-gray-800 p-4 rounded-md" id="review-shipping-address"></div>
</div>
<div>
<h3 class="font-semibold text-lg mb-2 text-accent" data-i18n="reviewPaymentMethod">Método de Pagamento</h3>
<div class="text-gray-300 bg-gray-800 p-4 rounded-md" id="review-payment-method"></div>
</div>
</div>
</div>
</form>
</div>
<aside class="w-full lg:w-1/3">
<div class="bg-primary p-6 rounded-lg shadow-lg sticky top-28">
<h3 class="text-2xl font-bold mb-6 border-b border-gray-700 pb-4" data-i18n="summaryTitle">Resumo do Pedido</h3>
<div class="space-y-4 mb-6 max-h-64 overflow-y-auto pr-2" id="checkout-item-list"></div>
<div class="border-t border-gray-700 pt-4 space-y-2">
<div class="flex justify-between">
<span class="text-gray-400" data-i18n="summarySubtotal">Subtotal</span>
<span class="font-semibold" id="checkout-subtotal">€0.00</span>
</div>
<div class="flex justify-between">
<span class="text-gray-400" data-i18n="summaryShipping">Envio</span>
<span class="font-semibold" data-i18n="summaryShippingFree">Grátis</span>
</div>
<div class="flex justify-between" id="discount-line" style="display: none;">
<span class="text-gray-400" data-i18n="summaryDiscount">Desconto Cupão</span>
<span class="font-semibold text-green-400" id="checkout-discount">- €0.00</span>
</div>
<div class="flex justify-between" id="loyalty-discount-line" style="display: none;">
    <span class="text-gray-400" data-i18n="summaryLoyaltyDiscount">Desconto de Fidelidade</span>
    <span class="font-semibold text-green-400" id="checkout-loyalty-discount">- €0.00</span>
</div>
<div class="border-t border-gray-700 pt-4 mt-4">
    <h4 class="font-semibold mb-2" data-i18n="loyaltyTitle">Pontos de Fidelidade</h4>
    <p class="text-sm text-gray-400 mb-2" data-i18n="loyaltyAvailable">Tem <span id="loyalty-points-available" class="font-bold text-accent">0</span> pontos disponíveis.</p>
    <div class="flex">
        <input type="number" id="loyalty-points-input" placeholder="Pontos a usar" class="w-full bg-gray-800 text-white px-4 py-2 rounded-l-md focus:outline-none focus:ring-2 focus:ring-accent form-input" data-i18n-placeholder="loyaltyPointsToUsePlaceholder">
        <button id="apply-loyalty-points-btn" class="btn btn-secondary px-4 rounded-l-none" data-i18n="loyaltyApplyBtn">Aplicar</button>
    </div>
    <p id="loyalty-message" class="text-sm mt-2 h-4"></p>
</div>
<div class="flex justify-between border-t border-gray-700 pt-4 mt-4">
<span class="text-lg font-bold" data-i18n="summaryTotal">Total</span>
<span class="text-lg font-bold text-accent" id="checkout-total">€0.00</span>
</div>
</div>
<div class="text-green-400 text-sm flex items-center mt-4 bg-secondary p-3 rounded-lg" id="checkout-privacy-label">
<i class="fas fa-shield-alt mr-2"></i>
<div>
<span data-i18n="securePurchaseNotice">Compra segura e envio 100% discreto.</span><br/>
<span class="text-xs" data-i18n-html="securePurchaseNoticeDetail">No extrato bancário aparecerá como: <strong>DP COMERCIAL</strong></span>
</div>
</div>
<div class="mt-6 space-y-3" id="checkout-buttons"></div>
</div>
</aside>
</div>
</div>
</div>
